<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stop Smoking Motivator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f2f4f6;
            color: #1a1a1a;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #ff6b6b;
        }

        .input-section {
            background: white;
            padding: 25px;
            border-radius: 6px;
            box-shadow: 0 1px 4px rgba(0,0,0,.05);
            margin-bottom: 30px;
        }

        .input-group {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }

        .input-field {
            flex: 1;
            min-width: 120px;
        }

        .input-field label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .input-field input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e1e5e9;
            border-radius: 4px;
            font-size: 16px;
            font-feature-settings: "tnum";
        }

        .input-field input:focus {
            outline: none;
            border-color: #ff6b6b;
        }

        .country-selector {
            margin-bottom: 20px;
        }

        .country-options {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .country-option {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .country-option input[type="radio"] {
            margin: 0;
        }

        .share-section {
            text-align: center;
            margin-bottom: 30px;
        }

        .share-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
        }

        .share-btn:hover {
            background: #e55a5a;
        }

        .stats-widget {
            background: white;
            padding: 30px;
            border-radius: 6px;
            box-shadow: 0 1px 4px rgba(0,0,0,.05);
            margin-bottom: 30px;
            text-align: center;
        }

        .stat-item {
            margin-bottom: 20px;
        }

        .stat-item:last-child {
            margin-bottom: 0;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            font-feature-settings: "tnum";
            color: #2ecc71;
            display: block;
        }

        .stat-label {
            font-size: 1.1rem;
            color: #666;
            margin-top: 5px;
        }

        .timeline {
            margin-bottom: 30px;
        }

        .timeline h2 {
            text-align: center;
            margin-bottom: 25px;
            color: #ff6b6b;
        }

        .timeline-container {
            display: grid;
            gap: 15px;
        }

        @media (min-width: 768px) {
            .timeline-container {
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            }
        }

        .milestone-card {
            background: white;
            padding: 20px;
            border-radius: 6px;
            box-shadow: 0 1px 4px rgba(0,0,0,.05);
            cursor: pointer;
            transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
            animation: fadeInUp 200ms ease-out;
        }

        .milestone-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,.1);
        }

        .milestone-card.completed {
            border-left: 4px solid #2ecc71;
        }

        .milestone-card.in-progress {
            border-left: 4px solid #ff6b6b;
        }

        .milestone-card.upcoming {
            border-left: 4px solid #e1e5e9;
            opacity: 0.7;
        }

        .milestone-time {
            font-weight: 700;
            font-size: 1.1rem;
            color: #ff6b6b;
            margin-bottom: 8px;
        }

        .milestone-benefit {
            color: #1a1a1a;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e1e5e9;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: #ff6b6b;
            transition: width 0.3s ease-out;
        }

        .motivation-quote {
            background: white;
            padding: 25px;
            border-radius: 6px;
            box-shadow: 0 1px 4px rgba(0,0,0,.05);
            text-align: center;
            margin-bottom: 30px;
            font-style: italic;
            font-size: 1.1rem;
            color: #666;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal-content {
            background: white;
            margin: 50px auto;
            padding: 30px;
            border-radius: 6px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .disclaimer {
            text-align: center;
            font-size: 0.75rem;
            opacity: 0.55;
            margin-top: 30px;
            color: #666;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 767px) {
            .input-group {
                flex-direction: column;
            }
            
            .country-options {
                flex-direction: column;
                gap: 10px;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üö≠ Stop Smoking Motivator</h1>
            <p>Track your progress and see the amazing benefits of quitting smoking</p>
        </header>

        <section class="input-section">
            <div class="input-group">
                <div class="input-field">
                    <label for="days">Days since last cigarette:</label>
                    <input type="number" id="days" min="0" value="0">
                </div>
                <div class="input-field">
                    <label for="hours">Hours since last cigarette:</label>
                    <input type="number" id="hours" min="0" max="23" value="0">
                </div>
                <div class="input-field">
                    <label for="avgCigs">Average cigarettes per day:</label>
                    <input type="number" id="avgCigs" min="1" value="20">
                </div>
            </div>

            <div class="country-selector">
                <label>Country:</label>
                <div class="country-options">
                    <div class="country-option">
                        <input type="radio" id="thailand" name="country" value="th" checked>
                        <label for="thailand">üáπüá≠ Thailand</label>
                    </div>
                    <div class="country-option">
                        <input type="radio" id="usa" name="country" value="us">
                        <label for="usa">üá∫üá∏ USA</label>
                    </div>
                </div>
            </div>

            <div class="input-field">
                <label for="packPrice">Pack price:</label>
                <input type="number" id="packPrice" min="0" step="0.01" value="70">
            </div>
        </section>

        <section class="share-section">
            <button class="share-btn" onclick="shareProgress()">üìã Share Progress</button>
        </section>

        <section class="stats-widget">
            <div class="stat-item">
                <span class="stat-value" id="timeElapsed">‚è≥ 0 days 0 h 0 m</span>
                <div class="stat-label">Time smoke-free</div>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="cigsAvoided">üö≠ 0 cigarettes avoided</span>
                <div class="stat-label">Cigarettes not smoked</div>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="moneySaved">üí∞ ‡∏ø 0 saved</span>
                <div class="stat-label">Money saved</div>
            </div>
        </section>

        <section class="motivation-quote">
            <div id="motivationText"></div>
        </section>

        <section class="timeline">
            <h2>Your Health Timeline</h2>
            <div class="timeline-container" id="timelineContainer">
                <!-- Timeline cards will be generated here -->
            </div>
        </section>

        <div class="disclaimer">
            Not medical advice. For information only.
        </div>
    </div>

    <!-- Modal for milestone details -->
    <div class="modal" id="milestoneModal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <script type="module">
        // sonnet4/index.html
        
        // Milestone data with detailed information
        const milestones = [
            {
                hours: 0,
                label: "Now",
                benefit: "Pulse & BP drop ‚Ä¢ temp of hands/feet rises",
                detail: "Within minutes of your last cigarette, your heart rate and blood pressure begin to normalize. The temperature in your hands and feet increases as circulation improves.",
                citations: ["WHO", "CDC"]
            },
            {
                hours: 4,
                label: "4 h",
                benefit: "CO in blood ‚Üì 50%",
                detail: "Carbon monoxide levels in your blood have dropped by half. Your blood can now carry more oxygen to your organs and tissues.",
                citations: ["CDC", "NHS"]
            },
            {
                hours: 8,
                label: "8 h",
                benefit: "O‚ÇÇ in blood ‚Üó to normal",
                detail: "Oxygen levels in your blood have returned to normal ranges. Your body's cells are getting the oxygen they need more efficiently.",
                citations: ["WHO", "Mayo Clinic"]
            },
            {
                hours: 12,
                label: "12 h",
                benefit: "Cough reflex starts to improve",
                detail: "Your cough reflex is beginning to recover, helping your lungs clear out mucus and other debris more effectively.",
                citations: ["NHS", "CDC"]
            },
            {
                hours: 24,
                label: "24 h",
                benefit: "Heart-attack risk begins ‚Üì",
                detail: "Your risk of heart attack has already begun to decrease. This is just the beginning of major cardiovascular improvements.",
                citations: ["WHO", "CDC"]
            },
            {
                hours: 36,
                label: "36 h",
                benefit: "Taste & smell noticeably sharper",
                detail: "Your senses of taste and smell are becoming noticeably sharper as nerve endings begin to heal and regrow.",
                citations: ["Mayo Clinic", "NHS"]
            },
            {
                hours: 48,
                label: "48 h",
                benefit: "CO gone ‚Ä¢ nerve endings regrow",
                detail: "Carbon monoxide is completely eliminated from your body. Damaged nerve endings are starting to regrow, improving taste and smell.",
                citations: ["CDC", "WHO"]
            },
            {
                hours: 60,
                label: "2.5 d",
                benefit: "Nicotine eliminated",
                detail: "All nicotine has been eliminated from your body. The physical addiction is broken, though psychological habits may persist.",
                citations: ["NHS", "Mayo Clinic"]
            },
            {
                hours: 72,
                label: "3 d",
                benefit: "Bronchi relax ‚Ä¢ breathing easier",
                detail: "Your bronchial tubes are relaxing and opening up, making breathing easier. You may notice less shortness of breath.",
                citations: ["WHO", "CDC"]
            },
            {
                hours: 96,
                label: "4 d",
                benefit: "Energy levels increase",
                detail: "Many people report increased energy levels as their body adjusts to life without nicotine and circulation continues to improve.",
                citations: ["Mayo Clinic", "NHS"]
            },
            {
                hours: 168,
                label: "1 w",
                benefit: "Sense of smell fully restored",
                detail: "Your sense of smell has likely returned to normal levels. Food will taste better and you'll be more sensitive to odors.",
                citations: ["CDC", "WHO"]
            },
            {
                hours: 336,
                label: "2 w",
                benefit: "Circulation improves ‚Ä¢ walking easier",
                detail: "Blood circulation has improved significantly. Walking and physical activity become easier as your heart and lungs work more efficiently.",
                citations: ["NHS", "Mayo Clinic"]
            },
            {
                hours: 720,
                label: "1 m",
                benefit: "Lung function +10%",
                detail: "Your lung function has improved by up to 10%. Coughing and shortness of breath continue to decrease.",
                citations: ["WHO", "CDC"]
            },
            {
                hours: 1440,
                label: "2 m",
                benefit: "Exercise endurance up",
                detail: "Your exercise endurance and overall physical performance have improved as your cardiovascular system continues to heal.",
                citations: ["Mayo Clinic", "NHS"]
            },
            {
                hours: 2160,
                label: "3 m",
                benefit: "Airway cilia regrow ‚Ä¢ chest clear",
                detail: "The tiny hairs (cilia) in your airways have regrown and are functioning properly, helping to clear your chest and reduce infection risk.",
                citations: ["CDC", "WHO"]
            },
            {
                hours: 4320,
                label: "6 m",
                benefit: "Coughing/wheezing cut by 50%",
                detail: "Coughing and wheezing have decreased by about 50%. Your lungs are much more effective at cleaning themselves.",
                citations: ["NHS", "Mayo Clinic"]
            },
            {
                hours: 8760,
                label: "1 y",
                benefit: "CHD risk ‚àí50%",
                detail: "Your risk of coronary heart disease has dropped by 50% compared to when you were smoking. This is a major health milestone.",
                citations: ["WHO", "CDC"]
            },
            {
                hours: 26280,
                label: "3 y",
                benefit: "Heart attack risk = non-smoker",
                detail: "Your risk of heart attack is now similar to someone who has never smoked. Your cardiovascular system has largely healed.",
                citations: ["CDC", "Mayo Clinic"]
            },
            {
                hours: 43800,
                label: "5 y",
                benefit: "Stroke risk = non-smoker",
                detail: "Your risk of stroke has decreased to that of a non-smoker. Your blood vessels have healed significantly.",
                citations: ["WHO", "NHS"]
            },
            {
                hours: 87600,
                label: "10 y",
                benefit: "Lung-cancer death risk ‚àí50%",
                detail: "Your risk of dying from lung cancer has dropped by 50% compared to continuing smokers. Other cancer risks have also decreased.",
                citations: ["CDC", "WHO"]
            },
            {
                hours: 157680,
                label: "18 y",
                benefit: "CHD risk ‚âà never-smoker",
                detail: "Your risk of coronary heart disease is now nearly identical to someone who has never smoked. You've achieved maximum cardiovascular recovery.",
                citations: ["Mayo Clinic", "CDC"]
            }
        ];

        // Motivational quotes
        const motivationalQuotes = [
            "Every cigarette you don't smoke is a victory.",
            "Your body is healing itself right now.",
            "You're stronger than your cravings.",
            "Each smoke-free day is an investment in your future.",
            "Your lungs are thanking you every breath you take.",
            "You've already overcome the hardest part.",
            "Your family is proud of your commitment.",
            "Every dollar saved is a reward for your willpower.",
            "You're not just quitting smoking, you're choosing life.",
            "Your taste buds are celebrating their freedom.",
            "You're an inspiration to others who want to quit.",
            "Your heart is getting stronger every day.",
            "You're proving that you can overcome anything.",
            "Your future self will thank you for this decision.",
            "You're breaking free from addiction's chains.",
            "Your energy levels are returning to normal.",
            "You're setting a powerful example for your loved ones.",
            "Every smoke-free moment is a step toward better health.",
            "You're reclaiming control over your life.",
            "Your commitment to health is admirable.",
            "You're healing from the inside out.",
            "Your willpower is stronger than any addiction.",
            "You're choosing long-term happiness over short-term relief.",
            "Your body is amazing at healing itself.",
            "You're worth the effort it takes to stay smoke-free.",
            "Your breathing is getting easier every day.",
            "You're saving money and your health at the same time.",
            "Your determination is your superpower.",
            "You're creating new, healthier habits.",
            "Your journey to better health has begun."
        ];

        // Global state
        let quitEpoch = null;
        let updateInterval = null;

        // Initialize app
        function init() {
            loadFromStorage();
            loadFromURL();
            setupEventListeners();
            displayRandomQuote();
            startUpdateLoop();
        }

        // Load data from localStorage
        function loadFromStorage() {
            const saved = localStorage.getItem('quitData');
            if (saved) {
                const data = JSON.parse(saved);
                if (data.quitEpoch) quitEpoch = data.quitEpoch;
                if (data.avgCigsPerDay) document.getElementById('avgCigs').value = data.avgCigsPerDay;
                if (data.country) {
                    document.querySelector(`input[value="${data.country}"]`).checked = true;
                    updatePackPrice();
                }
                if (data.packPrice) document.getElementById('packPrice').value = data.packPrice;
            }
        }

        // Load data from URL hash
        function loadFromURL() {
            const hash = window.location.hash.substring(1);
            if (hash) {
                const params = new URLSearchParams(hash);
                const days = params.get('d');
                const hours = params.get('h');
                const cigs = params.get('c');
                const country = params.get('ct');

                if (days !== null) document.getElementById('days').value = days;
                if (hours !== null) document.getElementById('hours').value = hours;
                if (cigs !== null) document.getElementById('avgCigs').value = cigs;
                if (country) {
                    document.querySelector(`input[value="${country}"]`).checked = true;
                    updatePackPrice();
                }
                
                updateQuitTime();
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            document.getElementById('days').addEventListener('input', updateQuitTime);
            document.getElementById('hours').addEventListener('input', updateQuitTime);
            document.getElementById('avgCigs').addEventListener('input', saveToStorage);
            document.getElementById('packPrice').addEventListener('input', saveToStorage);
            
            document.querySelectorAll('input[name="country"]').forEach(radio => {
                radio.addEventListener('change', () => {
                    updatePackPrice();
                    saveToStorage();
                });
            });

            // Close modal when clicking outside
            document.getElementById('milestoneModal').addEventListener('click', (e) => {
                if (e.target.id === 'milestoneModal') {
                    closeModal();
                }
            });
        }

        // Update quit time based on input
        function updateQuitTime() {
            const days = parseInt(document.getElementById('days').value) || 0;
            const hours = parseInt(document.getElementById('hours').value) || 0;
            
            const totalHours = days * 24 + hours;
            quitEpoch = Date.now() - (totalHours * 60 * 60 * 1000);
            
            saveToStorage();
            updateDisplay();
        }

        // Update pack price based on country
        function updatePackPrice() {
            const country = document.querySelector('input[name="country"]:checked').value;
            const packPriceInput = document.getElementById('packPrice');
            
            if (country === 'th') {
                packPriceInput.value = '70';
            } else {
                packPriceInput.value = '8';
            }
        }

        // Save data to localStorage
        function saveToStorage() {
            const data = {
                quitEpoch: quitEpoch,
                avgCigsPerDay: document.getElementById('avgCigs').value,
                country: document.querySelector('input[name="country"]:checked').value,
                packPrice: document.getElementById('packPrice').value
            };
            localStorage.setItem('quitData', JSON.stringify(data));
        }

        // Display random motivational quote
        function displayRandomQuote() {
            const randomQuote = motivationalQuotes[Math.floor(Math.random() * motivationalQuotes.length)];
            document.getElementById('motivationText').textContent = `"${randomQuote}"`;
        }

        // Start the update loop
        function startUpdateLoop() {
            updateDisplay();
            updateInterval = setInterval(updateDisplay, 1000);
        }

        // Main update function
        function updateDisplay() {
            if (!quitEpoch) {
                updateQuitTime();
                return;
            }

            const now = Date.now();
            const elapsedMs = now - quitEpoch;
            const elapsedHours = elapsedMs / (1000 * 60 * 60);

            updateTimeDisplay(elapsedMs);
            updateStatsDisplay(elapsedHours);
            updateTimeline(elapsedHours);
        }

        // Update time elapsed display
        function updateTimeDisplay(elapsedMs) {
            const totalMinutes = Math.floor(elapsedMs / (1000 * 60));
            const days = Math.floor(totalMinutes / (24 * 60));
            const hours = Math.floor((totalMinutes % (24 * 60)) / 60);
            const minutes = totalMinutes % 60;

            document.getElementById('timeElapsed').textContent = `‚è≥ ${days} days ${hours} h ${minutes} m`;
        }

        // Update stats display
        function updateStatsDisplay(elapsedHours) {
            const avgCigsPerDay = parseFloat(document.getElementById('avgCigs').value) || 20;
            const packPrice = parseFloat(document.getElementById('packPrice').value) || 70;
            const country = document.querySelector('input[name="country"]:checked').value;

            const cigsAvoided = Math.floor(elapsedHours * avgCigsPerDay / 24);
            const pricePerCig = packPrice / 20;
            const moneySaved = cigsAvoided * pricePerCig;

            document.getElementById('cigsAvoided').textContent = `üö≠ ${cigsAvoided} cigarettes avoided`;
            
            const currencySymbol = country === 'th' ? '‡∏ø' : '$';
            document.getElementById('moneySaved').textContent = `üí∞ ${currencySymbol} ${moneySaved.toFixed(0)} saved`;
        }

        // Update timeline display
        function updateTimeline(elapsedHours) {
            const container = document.getElementById('timelineContainer');
            container.innerHTML = '';

            milestones.forEach(milestone => {
                const card = document.createElement('div');
                card.className = 'milestone-card';
                
                let status, progressHtml = '';
                if (elapsedHours >= milestone.hours) {
                    status = 'completed';
                } else if (milestone.hours > 0 && elapsedHours >= milestone.hours * 0.1) {
                    status = 'in-progress';
                    const progress = Math.min(100, (elapsedHours / milestone.hours) * 100);
                    progressHtml = `
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progress}%"></div>
                        </div>
                    `;
                } else {
                    status = 'upcoming';
                }

                card.classList.add(status);
                card.innerHTML = `
                    <div class="milestone-time">${milestone.label}</div>
                    <div class="milestone-benefit">${milestone.benefit}</div>
                    ${progressHtml}
                `;

                card.addEventListener('click', () => showMilestoneDetail(milestone));
                container.appendChild(card);
            });
        }

        // Show milestone detail modal
        function showMilestoneDetail(milestone) {
            const modal = document.getElementById('milestoneModal');
            const content = document.getElementById('modalContent');
            
            content.innerHTML = `
                <h3>${milestone.label} - ${milestone.benefit}</h3>
                <p>${milestone.detail}</p>
                <p><strong>Sources:</strong> ${milestone.citations.join(', ')}</p>
            `;
            
            modal.style.display = 'block';
        }

        // Close modal
        window.closeModal = function() {
            document.getElementById('milestoneModal').style.display = 'none';
        };

        // Share progress function
        window.shareProgress = function() {
            const days = document.getElementById('days').value;
            const hours = document.getElementById('hours').value;
            const cigs = document.getElementById('avgCigs').value;
            const country = document.querySelector('input[name="country"]:checked').value;
            
            const hash = `#d=${days}&h=${hours}&c=${cigs}&ct=${country}`;
            const url = window.location.origin + window.location.pathname + hash;
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(url).then(() => {
                    alert('Progress link copied to clipboard!');
                });
            } else {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = url;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Progress link copied to clipboard!');
            }
        };

        // Initialize the app when DOM is loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>
